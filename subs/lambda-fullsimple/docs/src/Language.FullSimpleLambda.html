<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><a name="line-2"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.FullSimpleLambda</span><span>
</span><a name="line-3"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">module</span><span> </span><a href="Language.FullSimpleLambda.Types.html"><span class="hs-identifier">Language.FullSimpleLambda.Types</span></a><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><a href="Language.FullSimpleLambda.Parser.html"><span class="hs-identifier">Language.FullSimpleLambda.Parser</span></a><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><a href="Language.FullSimpleLambda.Pretty.html"><span class="hs-identifier">Language.FullSimpleLambda.Pretty</span></a><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Language.FullSimpleLambda.TypeCheck.html#typeof"><span class="hs-identifier hs-var">typeof</span></a><span>
</span><a name="line-7"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Language.FullSimpleLambda.html#desugar"><span class="hs-identifier hs-var">desugar</span></a><span>
</span><a name="line-8"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">RIO</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">RIO.List.Partial</span><span>                    </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L.Partial</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span>           </span><a href="Language.FullSimpleLambda.Internal.html"><span class="hs-identifier">Language.FullSimpleLambda.Internal</span></a><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span>           </span><a href="Language.FullSimpleLambda.Parser.html"><span class="hs-identifier">Language.FullSimpleLambda.Parser</span></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span>           </span><a href="Language.FullSimpleLambda.Pretty.html"><span class="hs-identifier">Language.FullSimpleLambda.Pretty</span></a><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span>           </span><a href="Language.FullSimpleLambda.TypeCheck.html"><span class="hs-identifier">Language.FullSimpleLambda.TypeCheck</span></a><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span>           </span><a href="Language.FullSimpleLambda.Types.html"><span class="hs-identifier">Language.FullSimpleLambda.Types</span></a><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Monoid</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-comment">-- | &#23450;&#32681;6.2.1 (P.60)</span><span>
</span><a name="line-23"></a><span class="hs-comment">--</span><span>
</span><a name="line-24"></a><span class="hs-comment">-- c: &#25171;&#12385;&#20999;&#12426;&#20516;</span><span>
</span><a name="line-25"></a><span class="hs-comment">--</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- d: &#12471;&#12501;&#12488;&#25968;</span><span>
</span><a name="line-27"></a><span class="hs-identifier">shift</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Term"><span class="hs-identifier hs-type">Term</span></a><span>
</span><a name="line-28"></a><a name="shift"><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier">shift</span></a></a><span> </span><a name="local-6989586621679107595"><a href="#local-6989586621679107595"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107596"><a href="#local-6989586621679107596"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmVar"><span class="hs-identifier hs-var">TmVar</span></a><span> </span><a name="local-6989586621679107597"><a href="#local-6989586621679107597"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679107597"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679107595"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmVar"><span class="hs-identifier hs-var">TmVar</span></a><span> </span><a href="#local-6989586621679107597"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-30"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmVar"><span class="hs-identifier hs-var">TmVar</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107597"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679107596"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107598"><a href="#local-6989586621679107598"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107599"><a href="#local-6989586621679107599"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmLam"><span class="hs-identifier hs-var">TmLam</span></a><span> </span><a name="local-6989586621679107600"><a href="#local-6989586621679107600"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679107601"><a href="#local-6989586621679107601"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679107602"><a href="#local-6989586621679107602"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmLam"><span class="hs-identifier hs-var">TmLam</span></a><span> </span><a href="#local-6989586621679107600"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679107601"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107598"><span class="hs-identifier hs-var">c</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107599"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679107602"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-32"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107603"><a href="#local-6989586621679107603"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107604"><a href="#local-6989586621679107604"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmApp"><span class="hs-identifier hs-var">TmApp</span></a><span> </span><a name="local-6989586621679107605"><a href="#local-6989586621679107605"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107606"><a href="#local-6989586621679107606"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmApp"><span class="hs-identifier hs-var">TmApp</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><a href="#local-6989586621679107603"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679107604"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107605"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679107606"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-33"></a><span class="hs-identifier">shift</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmTrue"><span class="hs-identifier hs-var">TmTrue</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmTrue"><span class="hs-identifier hs-var">TmTrue</span></a><span>
</span><a name="line-34"></a><span class="hs-identifier">shift</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmFalse"><span class="hs-identifier hs-var">TmFalse</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmFalse"><span class="hs-identifier hs-var">TmFalse</span></a><span>
</span><a name="line-35"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107620"><a href="#local-6989586621679107620"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107621"><a href="#local-6989586621679107621"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmIf"><span class="hs-identifier hs-var">TmIf</span></a><span> </span><a name="local-6989586621679107622"><a href="#local-6989586621679107622"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107623"><a href="#local-6989586621679107623"><span class="hs-identifier">t2</span></a></a><span> </span><a name="local-6989586621679107624"><a href="#local-6989586621679107624"><span class="hs-identifier">t3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmIf"><span class="hs-identifier hs-var">TmIf</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><a href="#local-6989586621679107620"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679107621"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107622"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679107623"><span class="hs-identifier hs-var">t2</span></a><span> </span><a href="#local-6989586621679107624"><span class="hs-identifier hs-var">t3</span></a><span>
</span><a name="line-36"></a><span class="hs-identifier">shift</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmZero"><span class="hs-identifier hs-var">TmZero</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmZero"><span class="hs-identifier hs-var">TmZero</span></a><span>
</span><a name="line-37"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107625"><a href="#local-6989586621679107625"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107626"><a href="#local-6989586621679107626"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmSucc"><span class="hs-identifier hs-var">TmSucc</span></a><span> </span><a name="local-6989586621679107627"><a href="#local-6989586621679107627"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmSucc"><span class="hs-identifier hs-var">TmSucc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><a href="#local-6989586621679107625"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679107626"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679107627"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-38"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107628"><a href="#local-6989586621679107628"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107629"><a href="#local-6989586621679107629"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPred"><span class="hs-identifier hs-var">TmPred</span></a><span> </span><a name="local-6989586621679107630"><a href="#local-6989586621679107630"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmPred"><span class="hs-identifier hs-var">TmPred</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><a href="#local-6989586621679107628"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679107629"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679107630"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-39"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107631"><a href="#local-6989586621679107631"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107632"><a href="#local-6989586621679107632"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmIsZero"><span class="hs-identifier hs-var">TmIsZero</span></a><span> </span><a name="local-6989586621679107633"><a href="#local-6989586621679107633"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmIsZero"><span class="hs-identifier hs-var">TmIsZero</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><a href="#local-6989586621679107631"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679107632"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679107633"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-40"></a><span class="hs-identifier">shift</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmUnit"><span class="hs-identifier hs-var">TmUnit</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmUnit"><span class="hs-identifier hs-var">TmUnit</span></a><span>
</span><a name="line-41"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107634"><a href="#local-6989586621679107634"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107635"><a href="#local-6989586621679107635"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmSeq"><span class="hs-identifier hs-var">TmSeq</span></a><span> </span><a name="local-6989586621679107636"><a href="#local-6989586621679107636"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107637"><a href="#local-6989586621679107637"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmSeq"><span class="hs-identifier hs-var">TmSeq</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><a href="#local-6989586621679107634"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679107635"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107636"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679107637"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-42"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107638"><a href="#local-6989586621679107638"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107639"><a href="#local-6989586621679107639"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmWildcard"><span class="hs-identifier hs-var">TmWildcard</span></a><span> </span><a name="local-6989586621679107640"><a href="#local-6989586621679107640"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679107641"><a href="#local-6989586621679107641"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmWildcard"><span class="hs-identifier hs-var">TmWildcard</span></a><span> </span><a href="#local-6989586621679107640"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107638"><span class="hs-identifier hs-var">c</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107639"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679107641"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-43"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107642"><a href="#local-6989586621679107642"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107643"><a href="#local-6989586621679107643"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmAscribe"><span class="hs-identifier hs-var">TmAscribe</span></a><span> </span><a name="local-6989586621679107644"><a href="#local-6989586621679107644"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679107645"><a href="#local-6989586621679107645"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmAscribe"><span class="hs-identifier hs-var">TmAscribe</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107642"><span class="hs-identifier hs-var">c</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107643"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679107644"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107645"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-44"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107646"><a href="#local-6989586621679107646"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107647"><a href="#local-6989586621679107647"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmLet"><span class="hs-identifier hs-var">TmLet</span></a><span> </span><a name="local-6989586621679107648"><a href="#local-6989586621679107648"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679107649"><a href="#local-6989586621679107649"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107650"><a href="#local-6989586621679107650"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmLet"><span class="hs-identifier hs-var">TmLet</span></a><span> </span><a href="#local-6989586621679107648"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><a href="#local-6989586621679107646"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679107647"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679107649"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107646"><span class="hs-identifier hs-var">c</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107647"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679107650"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- TODO (check)</span><span>
</span><a name="line-45"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107651"><a href="#local-6989586621679107651"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107652"><a href="#local-6989586621679107652"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPair"><span class="hs-identifier hs-var">TmPair</span></a><span> </span><a name="local-6989586621679107653"><a href="#local-6989586621679107653"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107654"><a href="#local-6989586621679107654"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPair"><span class="hs-identifier hs-var">TmPair</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><a href="#local-6989586621679107651"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679107652"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107653"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679107654"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-46"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107655"><a href="#local-6989586621679107655"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107656"><a href="#local-6989586621679107656"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPairFst"><span class="hs-identifier hs-var">TmPairFst</span></a><span> </span><a name="local-6989586621679107657"><a href="#local-6989586621679107657"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmPairFst"><span class="hs-identifier hs-var">TmPairFst</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><a href="#local-6989586621679107655"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679107656"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679107657"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-47"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107658"><a href="#local-6989586621679107658"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107659"><a href="#local-6989586621679107659"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPairSnd"><span class="hs-identifier hs-var">TmPairSnd</span></a><span> </span><a name="local-6989586621679107660"><a href="#local-6989586621679107660"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmPairSnd"><span class="hs-identifier hs-var">TmPairSnd</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><a href="#local-6989586621679107658"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679107659"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679107660"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-48"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107661"><a href="#local-6989586621679107661"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107662"><a href="#local-6989586621679107662"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmTuple"><span class="hs-identifier hs-var">TmTuple</span></a><span> </span><a name="local-6989586621679107663"><a href="#local-6989586621679107663"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmTuple"><span class="hs-identifier hs-var">TmTuple</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><a href="#local-6989586621679107661"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679107662"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107663"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-49"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107664"><a href="#local-6989586621679107664"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107665"><a href="#local-6989586621679107665"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmTupleProj"><span class="hs-identifier hs-var">TmTupleProj</span></a><span> </span><a name="local-6989586621679107666"><a href="#local-6989586621679107666"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679107667"><a href="#local-6989586621679107667"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmTupleProj"><span class="hs-identifier hs-var">TmTupleProj</span></a><span> </span><a href="#local-6989586621679107666"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><a href="#local-6989586621679107664"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679107665"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679107667"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-50"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107668"><a href="#local-6989586621679107668"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107669"><a href="#local-6989586621679107669"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmRecord"><span class="hs-identifier hs-var">TmRecord</span></a><span> </span><a name="local-6989586621679107670"><a href="#local-6989586621679107670"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmRecord"><span class="hs-identifier hs-var">TmRecord</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679107671"><a href="#local-6989586621679107671"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a name="local-6989586621679107672"><a href="#local-6989586621679107672"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107671"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><a href="#local-6989586621679107668"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679107669"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679107672"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107670"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-51"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107673"><a href="#local-6989586621679107673"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107674"><a href="#local-6989586621679107674"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmRecordProj"><span class="hs-identifier hs-var">TmRecordProj</span></a><span> </span><a name="local-6989586621679107675"><a href="#local-6989586621679107675"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679107676"><a href="#local-6989586621679107676"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmRecordProj"><span class="hs-identifier hs-var">TmRecordProj</span></a><span> </span><a href="#local-6989586621679107675"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><a href="#local-6989586621679107673"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679107674"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679107676"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-52"></a><span class="hs-identifier">shift</span><span> </span><a name="local-6989586621679107677"><a href="#local-6989586621679107677"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679107678"><a href="#local-6989586621679107678"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPattern"><span class="hs-identifier hs-var">TmPattern</span></a><span> </span><a name="local-6989586621679107679"><a href="#local-6989586621679107679"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679107680"><a href="#local-6989586621679107680"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107681"><a href="#local-6989586621679107681"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmPattern"><span class="hs-identifier hs-var">TmPattern</span></a><span> </span><a href="#local-6989586621679107679"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><a href="#local-6989586621679107677"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679107678"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679107680"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107677"><span class="hs-identifier hs-var">c</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107678"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679107681"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- TODO (check, &#38291;&#36949;&#12387;&#12390;&#12427;&#12363;&#12418;)</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-comment">-- | &#23450;&#32681; 6.2.4 (P.60)</span><span>
</span><a name="line-55"></a><span class="hs-comment">--</span><span>
</span><a name="line-56"></a><span class="hs-comment">-- j: &#22793;&#25968;&#30058;&#21495;</span><span>
</span><a name="line-57"></a><span class="hs-comment">--</span><span>
</span><a name="line-58"></a><span class="hs-comment">-- s: &#20195;&#20837;&#12377;&#12427;&#20516;</span><span>
</span><a name="line-59"></a><span class="hs-identifier">subst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Term"><span class="hs-identifier hs-type">Term</span></a><span>
</span><a name="line-60"></a><a name="subst"><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier">subst</span></a></a><span> </span><a name="local-6989586621679107682"><a href="#local-6989586621679107682"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107683"><a href="#local-6989586621679107683"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679107684"><a href="#local-6989586621679107684"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmVar"><span class="hs-identifier hs-var">TmVar</span></a><span> </span><a name="local-6989586621679107685"><a href="#local-6989586621679107685"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679107685"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679107682"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679107683"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-62"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679107684"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-63"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107686"><a href="#local-6989586621679107686"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107687"><a href="#local-6989586621679107687"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmLam"><span class="hs-identifier hs-var">TmLam</span></a><span> </span><a name="local-6989586621679107688"><a href="#local-6989586621679107688"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679107689"><a href="#local-6989586621679107689"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679107690"><a href="#local-6989586621679107690"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmLam"><span class="hs-identifier hs-var">TmLam</span></a><span> </span><a href="#local-6989586621679107688"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679107689"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107686"><span class="hs-identifier hs-var">j</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679107687"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107690"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-64"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107691"><a href="#local-6989586621679107691"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107692"><a href="#local-6989586621679107692"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmApp"><span class="hs-identifier hs-var">TmApp</span></a><span> </span><a name="local-6989586621679107693"><a href="#local-6989586621679107693"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107694"><a href="#local-6989586621679107694"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmApp"><span class="hs-identifier hs-var">TmApp</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107691"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107692"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107693"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679107694"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-65"></a><span class="hs-identifier">subst</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmTrue"><span class="hs-identifier hs-var">TmTrue</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmTrue"><span class="hs-identifier hs-var">TmTrue</span></a><span>
</span><a name="line-66"></a><span class="hs-identifier">subst</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmFalse"><span class="hs-identifier hs-var">TmFalse</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmFalse"><span class="hs-identifier hs-var">TmFalse</span></a><span>
</span><a name="line-67"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107695"><a href="#local-6989586621679107695"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107696"><a href="#local-6989586621679107696"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmIf"><span class="hs-identifier hs-var">TmIf</span></a><span> </span><a name="local-6989586621679107697"><a href="#local-6989586621679107697"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107698"><a href="#local-6989586621679107698"><span class="hs-identifier">t2</span></a></a><span> </span><a name="local-6989586621679107699"><a href="#local-6989586621679107699"><span class="hs-identifier">t3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmIf"><span class="hs-identifier hs-var">TmIf</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107695"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107696"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107697"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679107698"><span class="hs-identifier hs-var">t2</span></a><span> </span><a href="#local-6989586621679107699"><span class="hs-identifier hs-var">t3</span></a><span>
</span><a name="line-68"></a><span class="hs-identifier">subst</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmZero"><span class="hs-identifier hs-var">TmZero</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmZero"><span class="hs-identifier hs-var">TmZero</span></a><span>
</span><a name="line-69"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107700"><a href="#local-6989586621679107700"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107701"><a href="#local-6989586621679107701"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmSucc"><span class="hs-identifier hs-var">TmSucc</span></a><span> </span><a name="local-6989586621679107702"><a href="#local-6989586621679107702"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmSucc"><span class="hs-identifier hs-var">TmSucc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107700"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107701"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679107702"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-70"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107703"><a href="#local-6989586621679107703"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107704"><a href="#local-6989586621679107704"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPred"><span class="hs-identifier hs-var">TmPred</span></a><span> </span><a name="local-6989586621679107705"><a href="#local-6989586621679107705"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmPred"><span class="hs-identifier hs-var">TmPred</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107703"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107704"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679107705"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-71"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107706"><a href="#local-6989586621679107706"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107707"><a href="#local-6989586621679107707"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmIsZero"><span class="hs-identifier hs-var">TmIsZero</span></a><span> </span><a name="local-6989586621679107708"><a href="#local-6989586621679107708"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmIsZero"><span class="hs-identifier hs-var">TmIsZero</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107706"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107707"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679107708"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-72"></a><span class="hs-identifier">subst</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmUnit"><span class="hs-identifier hs-var">TmUnit</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmUnit"><span class="hs-identifier hs-var">TmUnit</span></a><span>
</span><a name="line-73"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107709"><a href="#local-6989586621679107709"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107710"><a href="#local-6989586621679107710"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmSeq"><span class="hs-identifier hs-var">TmSeq</span></a><span> </span><a name="local-6989586621679107711"><a href="#local-6989586621679107711"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107712"><a href="#local-6989586621679107712"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmSeq"><span class="hs-identifier hs-var">TmSeq</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107709"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107710"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107711"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679107712"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-74"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107713"><a href="#local-6989586621679107713"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107714"><a href="#local-6989586621679107714"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmWildcard"><span class="hs-identifier hs-var">TmWildcard</span></a><span> </span><a name="local-6989586621679107715"><a href="#local-6989586621679107715"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679107716"><a href="#local-6989586621679107716"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmWildcard"><span class="hs-identifier hs-var">TmWildcard</span></a><span> </span><a href="#local-6989586621679107715"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107713"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107714"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679107716"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-75"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107717"><a href="#local-6989586621679107717"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107718"><a href="#local-6989586621679107718"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmAscribe"><span class="hs-identifier hs-var">TmAscribe</span></a><span> </span><a name="local-6989586621679107719"><a href="#local-6989586621679107719"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679107720"><a href="#local-6989586621679107720"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmAscribe"><span class="hs-identifier hs-var">TmAscribe</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107717"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107718"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679107719"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107720"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-76"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107721"><a href="#local-6989586621679107721"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107722"><a href="#local-6989586621679107722"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmLet"><span class="hs-identifier hs-var">TmLet</span></a><span> </span><a name="local-6989586621679107723"><a href="#local-6989586621679107723"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679107724"><a href="#local-6989586621679107724"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107725"><a href="#local-6989586621679107725"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmLet"><span class="hs-identifier hs-var">TmLet</span></a><span> </span><a href="#local-6989586621679107723"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107721"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107722"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679107724"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107721"><span class="hs-identifier hs-var">j</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679107722"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107725"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- TODO check</span><span>
</span><a name="line-77"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107726"><a href="#local-6989586621679107726"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107727"><a href="#local-6989586621679107727"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPair"><span class="hs-identifier hs-var">TmPair</span></a><span> </span><a name="local-6989586621679107728"><a href="#local-6989586621679107728"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107729"><a href="#local-6989586621679107729"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPair"><span class="hs-identifier hs-var">TmPair</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107726"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107727"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107728"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679107729"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-78"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107730"><a href="#local-6989586621679107730"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107731"><a href="#local-6989586621679107731"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPairFst"><span class="hs-identifier hs-var">TmPairFst</span></a><span> </span><a name="local-6989586621679107732"><a href="#local-6989586621679107732"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmPairFst"><span class="hs-identifier hs-var">TmPairFst</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107730"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107731"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679107732"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-79"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107733"><a href="#local-6989586621679107733"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107734"><a href="#local-6989586621679107734"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPairSnd"><span class="hs-identifier hs-var">TmPairSnd</span></a><span> </span><a name="local-6989586621679107735"><a href="#local-6989586621679107735"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmPairSnd"><span class="hs-identifier hs-var">TmPairSnd</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107733"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107734"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679107735"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-80"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107736"><a href="#local-6989586621679107736"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107737"><a href="#local-6989586621679107737"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmTuple"><span class="hs-identifier hs-var">TmTuple</span></a><span> </span><a name="local-6989586621679107738"><a href="#local-6989586621679107738"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmTuple"><span class="hs-identifier hs-var">TmTuple</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107736"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107737"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107738"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-81"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107739"><a href="#local-6989586621679107739"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107740"><a href="#local-6989586621679107740"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmTupleProj"><span class="hs-identifier hs-var">TmTupleProj</span></a><span> </span><a name="local-6989586621679107741"><a href="#local-6989586621679107741"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679107742"><a href="#local-6989586621679107742"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmTupleProj"><span class="hs-identifier hs-var">TmTupleProj</span></a><span> </span><a href="#local-6989586621679107741"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107739"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107740"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679107742"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-82"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107743"><a href="#local-6989586621679107743"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107744"><a href="#local-6989586621679107744"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmRecord"><span class="hs-identifier hs-var">TmRecord</span></a><span> </span><a name="local-6989586621679107745"><a href="#local-6989586621679107745"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmRecord"><span class="hs-identifier hs-var">TmRecord</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679107746"><a href="#local-6989586621679107746"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a name="local-6989586621679107747"><a href="#local-6989586621679107747"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107746"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107743"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107744"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679107747"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107745"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-83"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107748"><a href="#local-6989586621679107748"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107749"><a href="#local-6989586621679107749"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmRecordProj"><span class="hs-identifier hs-var">TmRecordProj</span></a><span> </span><a name="local-6989586621679107750"><a href="#local-6989586621679107750"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679107751"><a href="#local-6989586621679107751"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmRecordProj"><span class="hs-identifier hs-var">TmRecordProj</span></a><span> </span><a href="#local-6989586621679107750"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107748"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107749"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679107751"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-84"></a><span class="hs-identifier">subst</span><span> </span><a name="local-6989586621679107752"><a href="#local-6989586621679107752"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679107753"><a href="#local-6989586621679107753"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPattern"><span class="hs-identifier hs-var">TmPattern</span></a><span> </span><a name="local-6989586621679107754"><a href="#local-6989586621679107754"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679107755"><a href="#local-6989586621679107755"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107756"><a href="#local-6989586621679107756"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmPattern"><span class="hs-identifier hs-var">TmPattern</span></a><span> </span><a href="#local-6989586621679107754"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107752"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679107753"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679107755"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107752"><span class="hs-identifier hs-var">j</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679107753"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107756"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- TODO check (&#38291;&#36949;&#12387;&#12390;&#12356;&#12381;&#12358;)</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Term"><span class="hs-identifier hs-type">Term</span></a><span>
</span><a name="line-87"></a><a name="eval"><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmIf"><span class="hs-identifier hs-var">TmIf</span></a><span> </span><a href="Language.FullSimpleLambda.Types.html#TmTrue"><span class="hs-identifier hs-var">TmTrue</span></a><span> </span><a name="local-6989586621679107757"><a href="#local-6989586621679107757"><span class="hs-identifier">t2</span></a></a><span> </span><a name="local-6989586621679107758"><a href="#local-6989586621679107758"><span class="hs-identifier">_t3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679107757"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-comment">-- E-IFTRUE</span><span>
</span><a name="line-88"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmIf"><span class="hs-identifier hs-var">TmIf</span></a><span> </span><a href="Language.FullSimpleLambda.Types.html#TmFalse"><span class="hs-identifier hs-var">TmFalse</span></a><span> </span><a name="local-6989586621679107759"><a href="#local-6989586621679107759"><span class="hs-identifier">_t2</span></a></a><span> </span><a name="local-6989586621679107760"><a href="#local-6989586621679107760"><span class="hs-identifier">t3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679107760"><span class="hs-identifier hs-var">t3</span></a><span> </span><span class="hs-comment">-- E-IFFALSE</span><span>
</span><a name="line-89"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmIf"><span class="hs-identifier hs-var">TmIf</span></a><span> </span><a name="local-6989586621679107761"><a href="#local-6989586621679107761"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107762"><a href="#local-6989586621679107762"><span class="hs-identifier">t2</span></a></a><span> </span><a name="local-6989586621679107763"><a href="#local-6989586621679107763"><span class="hs-identifier">t3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmIf"><span class="hs-identifier hs-var">TmIf</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107761"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107762"><span class="hs-identifier hs-var">t2</span></a><span> </span><a href="#local-6989586621679107763"><span class="hs-identifier hs-var">t3</span></a><span> </span><span class="hs-comment">-- E-IF</span><span>
</span><a name="line-90"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmSucc"><span class="hs-identifier hs-var">TmSucc</span></a><span> </span><a name="local-6989586621679107764"><a href="#local-6989586621679107764"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmSucc"><span class="hs-identifier hs-var">TmSucc</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107764"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- E-SUCC</span><span>
</span><a name="line-91"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPred"><span class="hs-identifier hs-var">TmPred</span></a><span> </span><a href="Language.FullSimpleLambda.Types.html#TmZero"><span class="hs-identifier hs-var">TmZero</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmZero"><span class="hs-identifier hs-var">TmZero</span></a><span> </span><span class="hs-comment">-- E-PREDZERO</span><span>
</span><a name="line-92"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPred"><span class="hs-identifier hs-var">TmPred</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmSucc"><span class="hs-identifier hs-var">TmSucc</span></a><span> </span><a name="local-6989586621679107765"><a href="#local-6989586621679107765"><span class="hs-identifier">nv</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Internal.html#isNumericValue"><span class="hs-identifier hs-var">isNumericValue</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679107765"><span class="hs-identifier hs-var">nv</span></a><span> </span><span class="hs-comment">-- E-PREDSUCC</span><span>
</span><a name="line-93"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPred"><span class="hs-identifier hs-var">TmPred</span></a><span> </span><a name="local-6989586621679107766"><a href="#local-6989586621679107766"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmPred"><span class="hs-identifier hs-var">TmPred</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107766"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- E-PRED</span><span>
</span><a name="line-94"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmIsZero"><span class="hs-identifier hs-var">TmIsZero</span></a><span> </span><a href="Language.FullSimpleLambda.Types.html#TmZero"><span class="hs-identifier hs-var">TmZero</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmTrue"><span class="hs-identifier hs-var">TmTrue</span></a><span> </span><span class="hs-comment">-- E-ISZEROZERO</span><span>
</span><a name="line-95"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmIsZero"><span class="hs-identifier hs-var">TmIsZero</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmSucc"><span class="hs-identifier hs-var">TmSucc</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Internal.html#isNumericValue"><span class="hs-identifier hs-var">isNumericValue</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmFalse"><span class="hs-identifier hs-var">TmFalse</span></a><span> </span><span class="hs-comment">-- E-ISZEROSUCC</span><span>
</span><a name="line-96"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmIsZero"><span class="hs-identifier hs-var">TmIsZero</span></a><span> </span><a name="local-6989586621679107767"><a href="#local-6989586621679107767"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmIsZero"><span class="hs-identifier hs-var">TmIsZero</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107767"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- E-ISZERO</span><span>
</span><a name="line-97"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmApp"><span class="hs-identifier hs-var">TmApp</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmLam"><span class="hs-identifier hs-var">TmLam</span></a><span> </span><a name="local-6989586621679107768"><a href="#local-6989586621679107768"><span class="hs-identifier">_x</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679107769"><a href="#local-6989586621679107769"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679107770"><a href="#local-6989586621679107770"><span class="hs-identifier">v2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679107770"><span class="hs-identifier hs-var">v2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107769"><span class="hs-identifier hs-var">t1</span></a><span class="hs-comment">-- E-APPABS</span><span>
</span><a name="line-98"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmApp"><span class="hs-identifier hs-var">TmApp</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmWildcard"><span class="hs-identifier hs-var">TmWildcard</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679107771"><a href="#local-6989586621679107771"><span class="hs-identifier">t12</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679107772"><a href="#local-6989586621679107772"><span class="hs-identifier">_t2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679107771"><span class="hs-identifier hs-var">t12</span></a><span> </span><span class="hs-comment">-- E-WILDCARD</span><span>
</span><a name="line-99"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmApp"><span class="hs-identifier hs-var">TmApp</span></a><span> </span><a name="local-6989586621679107773"><a href="#local-6989586621679107773"><span class="hs-identifier">v1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679107774"><a href="#local-6989586621679107774"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmApp"><span class="hs-identifier hs-var">TmApp</span></a><span> </span><a href="#local-6989586621679107773"><span class="hs-identifier hs-var">v1</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107774"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- E-APP2</span><span>
</span><a name="line-100"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmApp"><span class="hs-identifier hs-var">TmApp</span></a><span> </span><a name="local-6989586621679107775"><a href="#local-6989586621679107775"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107776"><a href="#local-6989586621679107776"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmApp"><span class="hs-identifier hs-var">TmApp</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107775"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107776"><span class="hs-identifier hs-var">t2</span></a><span>  </span><span class="hs-comment">-- E-APP1</span><span>
</span><a name="line-101"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmSeq"><span class="hs-identifier hs-var">TmSeq</span></a><span> </span><a name="local-6989586621679107777"><a href="#local-6989586621679107777"><span class="hs-identifier">_t1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679107778"><a href="#local-6989586621679107778"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679107778"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-comment">-- E-SEQNEXT</span><span>
</span><a name="line-102"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmSeq"><span class="hs-identifier hs-var">TmSeq</span></a><span> </span><a name="local-6989586621679107779"><a href="#local-6989586621679107779"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107780"><a href="#local-6989586621679107780"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmSeq"><span class="hs-identifier hs-var">TmSeq</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107779"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107780"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-comment">-- E-SEQ</span><span>
</span><a name="line-103"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmAscribe"><span class="hs-identifier hs-var">TmAscribe</span></a><span> </span><a name="local-6989586621679107781"><a href="#local-6989586621679107781"><span class="hs-identifier">v</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679107781"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-comment">-- E-ASCRIBE</span><span>
</span><a name="line-104"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmAscribe"><span class="hs-identifier hs-var">TmAscribe</span></a><span> </span><a name="local-6989586621679107782"><a href="#local-6989586621679107782"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107783"><a href="#local-6989586621679107783"><span class="hs-identifier">tyT</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmAscribe"><span class="hs-identifier hs-var">TmAscribe</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107782"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107783"><span class="hs-identifier hs-var">tyT</span></a><span> </span><span class="hs-comment">-- E-ASCRIBE1</span><span>
</span><a name="line-105"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmLet"><span class="hs-identifier hs-var">TmLet</span></a><span> </span><a name="local-6989586621679107784"><a href="#local-6989586621679107784"><span class="hs-identifier">_x</span></a></a><span> </span><a name="local-6989586621679107785"><a href="#local-6989586621679107785"><span class="hs-identifier">v1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679107786"><a href="#local-6989586621679107786"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#shift"><span class="hs-identifier hs-var">shift</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679107785"><span class="hs-identifier hs-var">v1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107786"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-comment">-- E-LETV</span><span>
</span><a name="line-106"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmLet"><span class="hs-identifier hs-var">TmLet</span></a><span> </span><a name="local-6989586621679107787"><a href="#local-6989586621679107787"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679107788"><a href="#local-6989586621679107788"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107789"><a href="#local-6989586621679107789"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmLet"><span class="hs-identifier hs-var">TmLet</span></a><span> </span><a href="#local-6989586621679107787"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107788"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107789"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-comment">-- E-LET</span><span>
</span><a name="line-107"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPairFst"><span class="hs-identifier hs-var">TmPairFst</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPair"><span class="hs-identifier hs-var">TmPair</span></a><span> </span><a name="local-6989586621679107790"><a href="#local-6989586621679107790"><span class="hs-identifier">v1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679107791"><a href="#local-6989586621679107791"><span class="hs-identifier">_v2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679107790"><span class="hs-identifier hs-var">v1</span></a><span> </span><span class="hs-comment">-- E-PAIRBETA1</span><span>
</span><a name="line-108"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPairSnd"><span class="hs-identifier hs-var">TmPairSnd</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPair"><span class="hs-identifier hs-var">TmPair</span></a><span> </span><a name="local-6989586621679107792"><a href="#local-6989586621679107792"><span class="hs-identifier">_v1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679107793"><a href="#local-6989586621679107793"><span class="hs-identifier">v2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679107793"><span class="hs-identifier hs-var">v2</span></a><span> </span><span class="hs-comment">-- E-PAIRBETA2</span><span>
</span><a name="line-109"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPairFst"><span class="hs-identifier hs-var">TmPairFst</span></a><span> </span><a name="local-6989586621679107794"><a href="#local-6989586621679107794"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmPairFst"><span class="hs-identifier hs-var">TmPairFst</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107794"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- E-PROJ1</span><span>
</span><a name="line-110"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPairSnd"><span class="hs-identifier hs-var">TmPairSnd</span></a><span> </span><a name="local-6989586621679107795"><a href="#local-6989586621679107795"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmPairSnd"><span class="hs-identifier hs-var">TmPairSnd</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107795"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- E-PROJ2</span><span>
</span><a name="line-111"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPair"><span class="hs-identifier hs-var">TmPair</span></a><span> </span><a name="local-6989586621679107796"><a href="#local-6989586621679107796"><span class="hs-identifier">v1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679107797"><a href="#local-6989586621679107797"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmPair"><span class="hs-identifier hs-var">TmPair</span></a><span> </span><a href="#local-6989586621679107796"><span class="hs-identifier hs-var">v1</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107797"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- E-PAIR2</span><span>
</span><a name="line-112"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPair"><span class="hs-identifier hs-var">TmPair</span></a><span> </span><a name="local-6989586621679107798"><a href="#local-6989586621679107798"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107799"><a href="#local-6989586621679107799"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmPair"><span class="hs-identifier hs-var">TmPair</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107798"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107799"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-comment">-- E-PAIR1</span><span>
</span><a name="line-113"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmTupleProj"><span class="hs-identifier hs-var">TmTupleProj</span></a><span> </span><a name="local-6989586621679107800"><a href="#local-6989586621679107800"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmTuple"><span class="hs-identifier hs-var">TmTuple</span></a><span> </span><a name="local-6989586621679107801"><a href="#local-6989586621679107801"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- E-PROJTUPLE</span><span>
</span><a name="line-114"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><a href="#local-6989586621679107801"><span class="hs-identifier hs-var">ts</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-115"></a><span>      </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679107800"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679107801"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-116"></a><span>      </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679107801"><span class="hs-identifier hs-var">ts</span></a><span> </span><span class="hs-operator hs-var">L.Partial.!!</span><span> </span><a href="#local-6989586621679107800"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-117"></a><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;&#12479;&#12503;&#12523;&#12398;&#12469;&#12452;&#12474;&#12424;&#12426;&#22823;&#12365;&#12394;&#20516;&#12364;&#25351;&#23450;&#12373;&#12428;&#12390;&#12356;&#12414;&#12377;&quot;</span><span>
</span><a name="line-118"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;eval: &#20516;&#12391;&#12399;&#12394;&#12356;&#38917;&#12364;&#23384;&#22312;&#12375;&#12414;&#12377;&#12290;&quot;</span><span>
</span><a name="line-119"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmTupleProj"><span class="hs-identifier hs-var">TmTupleProj</span></a><span> </span><a name="local-6989586621679107802"><a href="#local-6989586621679107802"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679107803"><a href="#local-6989586621679107803"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmTupleProj"><span class="hs-identifier hs-var">TmTupleProj</span></a><span> </span><a href="#local-6989586621679107802"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107803"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- E-PROJ</span><span>
</span><a name="line-120"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmTuple"><span class="hs-identifier hs-var">TmTuple</span></a><span> </span><a name="local-6989586621679107804"><a href="#local-6989586621679107804"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmTuple"><span class="hs-identifier hs-var">TmTuple</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107805"><span class="hs-identifier hs-var">vs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107806"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679107807"><span class="hs-identifier hs-var">ts'</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- E-TUPLE</span><span>
</span><a name="line-121"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679107805"><a href="#local-6989586621679107805"><span class="hs-identifier">vs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679107806"><a href="#local-6989586621679107806"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679107807"><a href="#local-6989586621679107807"><span class="hs-identifier">ts'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.html#splitTerm"><span class="hs-identifier hs-var">splitTerm</span></a><span> </span><a href="#local-6989586621679107804"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-122"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmRecordProj"><span class="hs-identifier hs-var">TmRecordProj</span></a><span> </span><span class="hs-keyword">label</span><span> </span><a name="local-6989586621679107809"><a href="#local-6989586621679107809"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmRecord"><span class="hs-identifier hs-var">TmRecord</span></a><span> </span><a name="local-6989586621679107810"><a href="#local-6989586621679107810"><span class="hs-identifier">fields</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- E-PROJRCD</span><span>
</span><a name="line-123"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><a href="#local-6989586621679107809"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-124"></a><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">lookup</span><span> </span><span class="hs-keyword">label</span><span> </span><a href="#local-6989586621679107810"><span class="hs-identifier hs-var">fields</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-125"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;field label not found (E-PROJRCD)&quot;</span><span>
</span><a name="line-126"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679107811"><a href="#local-6989586621679107811"><span class="hs-identifier">v</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679107811"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-127"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmRecordProj"><span class="hs-identifier hs-var">TmRecordProj</span></a><span> </span><span class="hs-keyword">label</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107809"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmRecordProj"><span class="hs-identifier hs-var">TmRecordProj</span></a><span> </span><span class="hs-keyword">label</span><span> </span><a name="local-6989586621679107813"><a href="#local-6989586621679107813"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmRecordProj"><span class="hs-identifier hs-var">TmRecordProj</span></a><span> </span><span class="hs-keyword">label</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107813"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- E-PROJ</span><span>
</span><a name="line-129"></a><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679107814"><a href="#local-6989586621679107814"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmRecord"><span class="hs-identifier hs-var">TmRecord</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679107814"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-comment">-- E-RCD</span><span>
</span><a name="line-130"></a><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679107815"><a href="#local-6989586621679107815"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmRecord"><span class="hs-identifier hs-var">TmRecord</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><a href="#local-6989586621679107815"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679107815"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-132"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmRecord"><span class="hs-identifier hs-var">TmRecord</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107816"><span class="hs-identifier hs-var">vfs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679107820"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679107819"><span class="hs-identifier hs-var">tfs</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- E-RCD</span><span>
</span><a name="line-133"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-134"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679107816"><a href="#local-6989586621679107816"><span class="hs-identifier">vfs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">label</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679107818"><a href="#local-6989586621679107818"><span class="hs-identifier">tj</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679107819"><a href="#local-6989586621679107819"><span class="hs-identifier">tfs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.html#splitRecord"><span class="hs-identifier hs-var">splitRecord</span></a><span> </span><a href="#local-6989586621679107815"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-135"></a><span>    </span><a name="local-6989586621679107820"><a href="#local-6989586621679107820"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">label</span><span class="hs-special">,</span><span> </span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107818"><span class="hs-identifier hs-var">tj</span></a><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPattern"><span class="hs-identifier hs-var">TmPattern</span></a><span> </span><a name="local-6989586621679107821"><a href="#local-6989586621679107821"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679107822"><a href="#local-6989586621679107822"><span class="hs-identifier">v</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679107823"><a href="#local-6989586621679107823"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.html#match"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679107821"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679107822"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679107823"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-comment">-- E-LETV (Pattern)</span><span>
</span><a name="line-137"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmPattern"><span class="hs-identifier hs-var">TmPattern</span></a><span> </span><a name="local-6989586621679107824"><a href="#local-6989586621679107824"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679107825"><a href="#local-6989586621679107825"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107826"><a href="#local-6989586621679107826"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmPattern"><span class="hs-identifier hs-var">TmPattern</span></a><span> </span><a href="#local-6989586621679107824"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679107825"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107826"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-comment">-- E-LET (Pattern)</span><span>
</span><a name="line-138"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;unexpected term&quot;</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-identifier">match</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Term"><span class="hs-identifier hs-type">Term</span></a><span class="hs-special">)</span><span>
</span><a name="line-141"></a><a name="match"><a href="Language.FullSimpleLambda.html#match"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#PtVar"><span class="hs-identifier hs-var">PtVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679107827"><a href="#local-6989586621679107827"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679107828"><a href="#local-6989586621679107828"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.html#subst"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679107827"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679107828"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-142"></a><span class="hs-identifier">match</span><span> </span><a name="local-6989586621679107829"><a href="#local-6989586621679107829"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#PtRecord"><span class="hs-identifier hs-var">PtRecord</span></a><span> </span><a name="local-6989586621679107830"><a href="#local-6989586621679107830"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679107831"><a href="#local-6989586621679107831"><span class="hs-identifier">v</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmRecord"><span class="hs-identifier hs-var">TmRecord</span></a><span> </span><a name="local-6989586621679107832"><a href="#local-6989586621679107832"><span class="hs-identifier">fs'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Language.FullSimpleLambda.Internal.html#isRecordValue"><span class="hs-identifier hs-var">isRecordValue</span></a><span> </span><a href="#local-6989586621679107831"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Language.FullSimpleLambda.html#sameFieldLength"><span class="hs-identifier hs-var">sameFieldLength</span></a><span> </span><a href="#local-6989586621679107829"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679107831"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-144"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">appEndo</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Endo</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="Language.FullSimpleLambda.html#match"><span class="hs-identifier hs-var">match</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679107830"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679107832"><span class="hs-identifier hs-var">fs'</span></a><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;match: pattern match failure&quot;</span><span>
</span><a name="line-146"></a><span class="hs-identifier">match</span><span> </span><a href="Language.FullSimpleLambda.Types.html#PtRecord"><span class="hs-identifier hs-var">PtRecord</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;match: v is not Rrcord&quot;</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-identifier">sameFieldLength</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-149"></a><a name="sameFieldLength"><a href="Language.FullSimpleLambda.html#sameFieldLength"><span class="hs-identifier">sameFieldLength</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#PtRecord"><span class="hs-identifier hs-var">PtRecord</span></a><span> </span><a name="local-6989586621679108522"><a href="#local-6989586621679108522"><span class="hs-identifier">fs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmRecord"><span class="hs-identifier hs-var">TmRecord</span></a><span> </span><a name="local-6989586621679108523"><a href="#local-6989586621679108523"><span class="hs-identifier">fs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679108522"><span class="hs-identifier hs-var">fs1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679108523"><span class="hs-identifier hs-var">fs2</span></a><span>
</span><a name="line-150"></a><span class="hs-identifier">sameFieldLength</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;unexpected field&quot;</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">-- | &#23550;&#35937;&#12398;&#27083;&#25991;</span><span>
</span><a name="line-153"></a><span class="hs-comment">--</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- TmSeq</span><span>
</span><a name="line-155"></a><span class="hs-comment">--</span><span>
</span><a name="line-156"></a><span class="hs-comment">-- TmWildcard</span><span>
</span><a name="line-157"></a><span class="hs-identifier">desugar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Term"><span class="hs-identifier hs-type">Term</span></a><span>
</span><a name="line-158"></a><a name="desugar"><a href="Language.FullSimpleLambda.html#desugar"><span class="hs-identifier">desugar</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmSeq"><span class="hs-identifier hs-var">TmSeq</span></a><span> </span><a name="local-6989586621679108524"><a href="#local-6989586621679108524"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679108525"><a href="#local-6989586621679108525"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmApp"><span class="hs-identifier hs-var">TmApp</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmLam"><span class="hs-identifier hs-var">TmLam</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TyUnit"><span class="hs-identifier hs-var">TyUnit</span></a><span> </span><a href="#local-6989586621679108525"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679108524"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-comment">-- FIXME x notin FV(t2)</span><span>
</span><a name="line-159"></a><span class="hs-identifier">desugar</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmWildcard"><span class="hs-identifier hs-var">TmWildcard</span></a><span> </span><a name="local-6989586621679108526"><a href="#local-6989586621679108526"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679108527"><a href="#local-6989586621679108527"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmLam"><span class="hs-identifier hs-var">TmLam</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span> </span><a href="#local-6989586621679108526"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679108527"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-comment">-- FIXME x notin FV(t)</span><span>
</span><a name="line-160"></a><span class="hs-identifier">desugar</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmAscribe"><span class="hs-identifier hs-var">TmAscribe</span></a><span> </span><a name="local-6989586621679108528"><a href="#local-6989586621679108528"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679108529"><a href="#local-6989586621679108529"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Language.FullSimpleLambda.Types.html#TmApp"><span class="hs-identifier hs-var">TmApp</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmLam"><span class="hs-identifier hs-var">TmLam</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span> </span><a href="#local-6989586621679108529"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmVar"><span class="hs-identifier hs-var">TmVar</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679108528"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-comment">-- FIXME x notin FV(t)</span><span>
</span><a name="line-161"></a><span class="hs-identifier">desugar</span><span> </span><a name="local-6989586621679108530"><a href="#local-6989586621679108530"><span class="hs-identifier">term</span></a></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679108530"><span class="hs-identifier hs-var">term</span></a><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">----------------------</span><span>
</span><a name="line-164"></a><span class="hs-comment">-- helper functions --</span><span>
</span><a name="line-165"></a><span class="hs-comment">----------------------</span><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span class="hs-comment">-- | &#23569;&#12394;&#12367;&#12392;&#12418;1&#12388;&#12399;&#38917;&#12391;&#12354;&#12427;</span><span>
</span><a name="line-168"></a><span class="hs-identifier">splitTerm</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Language.FullSimpleLambda.Types.html#Term"><span class="hs-identifier hs-type">Term</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Language.FullSimpleLambda.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Term"><span class="hs-identifier hs-type">Term</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Language.FullSimpleLambda.Types.html#Term"><span class="hs-identifier hs-type">Term</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-169"></a><a name="splitTerm"><a href="Language.FullSimpleLambda.html#splitTerm"><span class="hs-identifier">splitTerm</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;empty list is not expected&quot;</span><span>
</span><a name="line-170"></a><span class="hs-identifier">splitTerm</span><span> </span><a name="local-6989586621679108531"><a href="#local-6989586621679108531"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679108532"><span class="hs-identifier hs-var">vs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">L.Partial.head</span><span> </span><a href="#local-6989586621679108533"><span class="hs-identifier hs-var">ts'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">L.Partial.tail</span><span> </span><a href="#local-6989586621679108533"><span class="hs-identifier hs-var">ts'</span></a><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679108532"><a href="#local-6989586621679108532"><span class="hs-identifier">vs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679108533"><a href="#local-6989586621679108533"><span class="hs-identifier">ts'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">span</span><span> </span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><a href="#local-6989586621679108531"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-comment">-- | &#12524;&#12467;&#12540;&#12489;&#12398;&#12415;&#24819;&#23450;</span><span>
</span><a name="line-174"></a><span class="hs-identifier">splitRecord</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span class="hs-special">,</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span class="hs-special">,</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Term"><span class="hs-identifier hs-type">Term</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span class="hs-special">,</span><span> </span><a href="Language.FullSimpleLambda.Types.html#Term"><span class="hs-identifier hs-type">Term</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-175"></a><a name="splitRecord"><a href="Language.FullSimpleLambda.html#splitRecord"><span class="hs-identifier">splitRecord</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Types.html#TmRecord"><span class="hs-identifier hs-var">TmRecord</span></a><span> </span><a name="local-6989586621679108534"><a href="#local-6989586621679108534"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679108535"><span class="hs-identifier hs-var">vfs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">L.Partial.head</span><span> </span><a href="#local-6989586621679108536"><span class="hs-identifier hs-var">tfs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">L.Partial.tail</span><span> </span><a href="#local-6989586621679108536"><span class="hs-identifier hs-var">tfs</span></a><span class="hs-special">)</span><span>
</span><a name="line-176"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-177"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679108535"><a href="#local-6989586621679108535"><span class="hs-identifier">vfs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679108536"><a href="#local-6989586621679108536"><span class="hs-identifier">tfs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">span</span><span> </span><span class="hs-special">(</span><a href="Language.FullSimpleLambda.Internal.html#isValue"><span class="hs-identifier hs-var">isValue</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679108534"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-178"></a><span class="hs-identifier">splitRecord</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;only record&quot;</span><span>
</span><a name="line-179"></a></pre></body></html>